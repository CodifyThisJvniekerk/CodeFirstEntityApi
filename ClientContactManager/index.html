<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
    <script src="scripts/jquery-3.1.0.min.js"></script>
    <link href="App_Themes/Bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="App_Themes/Bootstrap/bootstrap.css" rel="stylesheet" />
    <script>
        var url = '/api/customers/GetCustomers'
        function getCustomers() {
            $('#Customers').children().remove();
            $('#Customers').show();
            $('#customerform').hide();
            $('<tr><td>Name</td><td>Latitude</td><td>Longitude</td></tr>').appendTo($('#Customers'));
            $(function () {
                $.getJSON(url, function (data) {
                    console.log(data);
                    for (item in data) {
                        $('<tr><td>' + data[item].Name + '</td><td>' + data[item].Latitude + '</td><td>' + data[item].Longitude + '</td></tr>').appendTo($('#Customers'));
                    }
                });
            });
        }
        function getCustomerByName() {
            url = '/SearchForCustomerByName/'
            $('#Customers').show();
            $('#Customers').children().remove();
            $('<tr><td>Name</td><td>Latitude</td><td>Longitude</td></tr>').appendTo($('#Customers'));
            $(function () {
                $.getJSON(url + '/'+ $('#txtCustSearck').val(), function (data) {
                    console.log(data);
                    for (item in data) {
                        $('<tr><td>' + data[item].Name + '</td><td>' + data[item].Latitude + '</td><td>' + data[item].Longitude + '</td></tr>').appendTo($('#Customers'));
                    }
                });
            });
        }
        function showCustomerForm(id) {
            if (id > 0) {

            } else {
                $('#customerform').show();
                $('#Customers').hide();
            }
        }
        function addCustomer() {
            console.log($('#txtCustLatitude').val());
            if ($('#txtCustName').val().trim() !== "") {
                if ($.isNumeric($('#txtCustLatitude').val()) && $.isNumeric($('#txtCustLongitude').val())) {
                    $.ajax({
                        type: "PUT",
                        url: "AddCustomer/" + $('#txtCustName').val() + '/' + $('#txtCustLatitude').val() + '/' + $('#txtCustLongitude').val(),
                        //data: JSON.stringify({ Nane: $('#txtCustName').val(), latitude: $('#txtCustLatitude').val(), Longitude:  $('#txtCustLongitude').val()}),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                        },
                        success: function (result) {
                            alert('customer saved.');
                            getCustomers();
                        }
                        });
                } else {
                    alert('Please ensure both the longitude and latitude is numerical.');
                }
            } else {
                alert('Please enter an customer name.');
            }
        }
    </script>
</head>
<body onload="getCustomers();">
    <input type="text" class="text-primary" id="txtCustSearck"/><input type="button" id="btnSearch" class="btn-info" value="Search" onclick="getCustomerByName();"/><input type="button" value="Add Customer" class="btn-info" onclick="showCustomerForm(0);"/>
    <table id="Customers" style="width:100%" class="table-striped">
        <tr>
            <td>

            </td>
        </tr>
    </table>
    <table id="customerform" style="display:none; width:50%" class="">
        <tr>
            <td>Name:</td>
            <td><input type="text" id="txtCustName"/></td>
        </tr>
        <tr>
            <td>Latitude</td>
            <td><input type="text" id="txtCustLatitude" /></td>
        </tr>
        <tr>
            <td>Longitude</td>
            <td><input type="text" id="txtCustLongitude" /></td>
        </tr>
        <tr>
            <td><input type="button" class="btn-info" value="Save" onclick="addCustomer();"/></td>
            <td></td>
        </tr>
    </table>
    

</body>
</html>
